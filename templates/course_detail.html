<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Details - LearnHub</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Source Sans Pro', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: #fff;
            color: #1f1f1f;
        }

        /* ========== NAVBAR ========== */
        .navbar {
            background: #1f1f1f;
            color: #fff;
            padding: 0 40px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .navbar-container {
            max-width: 1440px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 64px;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #0056d2;
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            align-items: center;
            gap: 24px;
        }

        .nav-link {
            color: #fff;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-link:hover {
            color: #0056d2;
        }

        /* ========== HERO SECTION ========== */
        .hero {
            background: #1f1f1f;
            color: #fff;
            padding: 48px 40px;
        }

        .hero-container {
            max-width: 1440px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 48px;
        }

        .hero-content h1 {
            font-size: 48px;
            font-weight: 700;
            line-height: 1.2;
            margin-bottom: 16px;
        }

        .hero-content p {
            font-size: 20px;
            line-height: 1.6;
            margin-bottom: 24px;
            opacity: 0.9;
        }

        .hero-meta {
            display: flex;
            align-items: center;
            gap: 32px;
            margin-bottom: 24px;
            font-size: 16px;
        }

        .hero-meta span {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .rating-stars {
            color: #ffa927;
        }

        .hero-tags {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .tag {
            padding: 6px 12px;
            background: rgba(255,255,255,0.15);
            border-radius: 4px;
            font-size: 14px;
            font-weight: 500;
        }

        /* ========== ENROLLMENT CARD ========== */
        .enrollment-card {
            background: #fff;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 8px 24px rgba(0,0,0,0.2);
            position: sticky;
            top: 80px;
        }

        .enrollment-preview {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            color: #fff;
            font-size: 48px;
        }

        .enrollment-body {
            padding: 24px;
        }

        .price {
            font-size: 36px;
            font-weight: 700;
            color: #1f1f1f;
            margin-bottom: 16px;
        }

        .price small {
            font-size: 18px;
            color: #666;
            text-decoration: line-through;
            margin-left: 12px;
        }

        .btn-enroll {
            width: 100%;
            padding: 16px;
            background: #0056d2;
            color: #fff;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 12px;
        }

        .btn-enroll:hover {
            background: #004bb5;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 86, 210, 0.3);
        }

        .btn-wishlist {
            width: 100%;
            padding: 12px;
            background: transparent;
            color: #1f1f1f;
            border: 2px solid #e0e0e0;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-wishlist:hover {
            border-color: #0056d2;
            color: #0056d2;
        }

        .enrollment-includes {
            margin-top: 24px;
            padding-top: 24px;
            border-top: 1px solid #e0e0e0;
        }

        .enrollment-includes h4 {
            font-size: 16px;
            font-weight: 700;
            margin-bottom: 16px;
            color: #1f1f1f;
        }

        .includes-list {
            list-style: none;
        }

        .includes-list li {
            padding: 8px 0;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #666;
            font-size: 14px;
        }

        .includes-list i {
            color: #00b894;
        }

        /* ========== MAIN CONTENT ========== */
        .main-content {
            max-width: 1440px;
            margin: 0 auto;
            padding: 60px 40px;
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 48px;
        }

        .content-section {
            background: #fff;
        }

        .section-title {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 24px;
            color: #1f1f1f;
        }

        .section-subtitle {
            font-size: 24px;
            font-weight: 700;
            margin-bottom: 16px;
            margin-top: 40px;
            color: #1f1f1f;
        }

        .description {
            font-size: 16px;
            line-height: 1.8;
            color: #666;
            margin-bottom: 32px;
        }

        /* ========== SYLLABUS ========== */
        .syllabus {
            margin-top: 40px;
        }

        .module {
            background: #f7f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            margin-bottom: 16px;
            overflow: hidden;
        }

        .module-header {
            padding: 20px 24px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: background 0.3s;
        }

        .module-header:hover {
            background: #e8f1fc;
        }

        .module-title {
            font-size: 18px;
            font-weight: 700;
            color: #1f1f1f;
        }

        .module-meta {
            font-size: 14px;
            color: #666;
            margin-top: 4px;
        }

        .module-toggle {
            font-size: 20px;
            color: #666;
        }

        .module-content {
            padding: 0 24px;
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .module.active .module-content {
            max-height: 1000px;
            padding: 20px 24px;
        }

        .module.active .module-toggle {
            transform: rotate(180deg);
        }

        .lesson-list {
            list-style: none;
        }

        .lesson-item {
            padding: 12px 0;
            display: flex;
            align-items: center;
            gap: 12px;
            border-bottom: 1px solid #e0e0e0;
        }

        .lesson-item:last-child {
            border-bottom: none;
        }

        .lesson-icon {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: #e8f1fc;
            color: #0056d2;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .lesson-info {
            flex: 1;
        }

        .lesson-title {
            font-size: 15px;
            font-weight: 600;
            color: #1f1f1f;
        }

        .lesson-duration {
            font-size: 13px;
            color: #666;
        }

        /* ========== INSTRUCTOR ========== */
        .instructor-card {
            background: #f7f9fa;
            padding: 32px;
            border-radius: 8px;
            margin-top: 40px;
        }

        .instructor-header {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
        }

        .instructor-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: #0056d2;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: 700;
            flex-shrink: 0;
        }

        .instructor-info h3 {
            font-size: 22px;
            font-weight: 700;
            color: #1f1f1f;
            margin-bottom: 4px;
        }

        .instructor-info p {
            font-size: 15px;
            color: #666;
            margin-bottom: 12px;
        }

        .instructor-stats {
            display: flex;
            gap: 24px;
            font-size: 14px;
            color: #666;
        }

        .instructor-bio {
            font-size: 15px;
            line-height: 1.6;
            color: #666;
        }

        /* ========== REVIEWS ========== */
        .reviews-summary {
            background: #f7f9fa;
            padding: 32px;
            border-radius: 8px;
            margin-bottom: 24px;
        }

        .reviews-grid {
            display: grid;
            grid-template-columns: auto 1fr;
            gap: 32px;
            align-items: center;
        }

        .rating-large {
            text-align: center;
        }

        .rating-large .number {
            font-size: 56px;
            font-weight: 700;
            color: #1f1f1f;
        }

        .rating-large .stars {
            color: #ffa927;
            font-size: 20px;
            margin-bottom: 8px;
        }

        .rating-large .count {
            font-size: 14px;
            color: #666;
        }

        .rating-bars {
            list-style: none;
        }

        .rating-bar-item {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 8px;
        }

        .bar-label {
            font-size: 14px;
            color: #666;
            width: 60px;
        }

        .bar {
            flex: 1;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .bar-fill {
            height: 100%;
            background: #ffa927;
            border-radius: 4px;
        }

        .bar-count {
            font-size: 14px;
            color: #666;
            width: 40px;
            text-align: right;
        }

        .review-list {
            list-style: none;
        }

        .review-item {
            padding: 24px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .review-header {
            display: flex;
            gap: 16px;
            margin-bottom: 12px;
        }

        .review-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background: #0056d2;
            color: #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
        }

        .review-meta h4 {
            font-size: 16px;
            font-weight: 700;
            color: #1f1f1f;
            margin-bottom: 4px;
        }

        .review-meta .stars {
            color: #ffa927;
            margin-right: 8px;
        }

        .review-meta .date {
            font-size: 13px;
            color: #999;
        }

        .review-text {
            font-size: 15px;
            line-height: 1.6;
            color: #666;
        }

        /* ========== SIDEBAR ========== */
        .sidebar-section {
            background: #f7f9fa;
            padding: 24px;
            border-radius: 8px;
            margin-bottom: 24px;
        }

        .sidebar-section h3 {
            font-size: 18px;
            font-weight: 700;
            margin-bottom: 16px;
            color: #1f1f1f;
        }

        .skills-list {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            list-style: none;
        }

        .skill-tag {
            padding: 8px 16px;
            background: #fff;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            font-size: 14px;
            color: #666;
        }

        /* ========== RESPONSIVE ========== */
        @media (max-width: 1200px) {
            .hero-container,
            .main-content {
                grid-template-columns: 1fr;
            }

            .enrollment-card {
                position: static;
            }
        }

        @media (max-width: 768px) {
            .navbar {
                padding: 0 20px;
            }

            .hero {
                padding: 32px 20px;
            }

            .hero-content h1 {
                font-size: 32px;
            }

            .main-content {
                padding: 40px 20px;
            }
        }
    </style>
</head>
<body>
    <!-- NAVBAR -->
    <nav class="navbar">
        <div class="navbar-container">
            <a href="/" class="logo">
                <i class="fas fa-graduation-cap"></i>
                <span>LearnHub</span>
            </a>
            <div class="nav-links">
                <a href="/" class="nav-link">Home</a>
                <a href="/courses" class="nav-link">Courses</a>
                <a href="/student/dashboard" class="nav-link" id="dashboardLink" style="display:none;">My Learning</a>
            </div>
        </div>
    </nav>

    <!-- HERO SECTION -->
    <section class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <h1 id="courseTitle">Loading...</h1>
                <p id="courseDescription">Please wait while we load the course details...</p>
                
                <div class="hero-meta">
                    <span class="rating-stars">
                        ★★★★★ <strong id="courseRating">4.8</strong> (<span id="ratingCount">1,234</span> ratings)
                    </span>
                    <span><i class="fas fa-users"></i> <span id="studentCount">0</span> students</span>
                </div>

                <div class="hero-tags" id="courseTags">
                    <span class="tag">Beginner</span>
                </div>
            </div>

            <div class="enrollment-card">
                <div class="enrollment-preview">
                    <i class="fas fa-play-circle"></i>
                </div>
                <div class="enrollment-body">
                    <div class="price" id="coursePrice">Free</div>
                    <button class="btn-enroll" id="enrollBtn" onclick="enrollCourse()">
                        <i class="fas fa-shopping-cart"></i> Enroll Now
                    </button>
                    <button class="btn-wishlist">
                        <i class="far fa-heart"></i> Add to Wishlist
                    </button>
                    
                    <div class="enrollment-includes">
                        <h4>This course includes:</h4>
                        <ul class="includes-list">
                            <li><i class="fas fa-check"></i> <span id="courseDuration">8 hours</span> on-demand video</li>
                            <li><i class="fas fa-check"></i> <span id="moduleCount">12</span> modules</li>
                            <li><i class="fas fa-check"></i> Certificate of completion</li>
                            <li><i class="fas fa-check"></i> Full lifetime access</li>
                            <li><i class="fas fa-check"></i> Access on mobile and desktop</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- MAIN CONTENT -->
    <div class="main-content">
        <div class="content-section">
            <!-- WHAT YOU'LL LEARN -->
            <section>
                <h2 class="section-title">What you'll learn</h2>
                <ul class="includes-list" id="learningObjectives">
                    <li><i class="fas fa-check"></i> Loading objectives...</li>
                </ul>
            </section>

            <!-- COURSE CONTENT -->
            <section class="syllabus">
                <h2 class="section-title">Course Content</h2>
                <div id="syllabusContainer">
                    <!-- Modules will be loaded here -->
                    <p style="color:#666; padding:20px 0;">Loading course content...</p>
                </div>
            </section>

            <!-- DESCRIPTION -->
            <section>
                <h2 class="section-title">Description</h2>
                <div class="description" id="fullDescription">
                    Loading course description...
                </div>
            </section>

            <!-- INSTRUCTOR -->
            <section>
                <h2 class="section-title">Instructor</h2>
                <div class="instructor-card">
                    <div class="instructor-header">
                        <div class="instructor-avatar" id="instructorAvatar">I</div>
                        <div class="instructor-info">
                            <h3 id="instructorName">Instructor Name</h3>
                            <p id="instructorTitle">Expert Instructor</p>
                            <div class="instructor-stats">
                                <span><i class="fas fa-star" style="color:#ffa927"></i> 4.8 Rating</span>
                                <span><i class="fas fa-users"></i> 10,000 Students</span>
                                <span><i class="fas fa-book"></i> 15 Courses</span>
                            </div>
                        </div>
                    </div>
                    <div class="instructor-bio" id="instructorBio">
                        Loading instructor information...
                    </div>
                </div>
            </section>

            <!-- REVIEWS -->
            <section>
                <h2 class="section-title">Student Reviews</h2>
                <div class="reviews-summary">
                    <div class="reviews-grid">
                        <div class="rating-large">
                            <div class="number" id="avgRating">4.8</div>
                            <div class="stars">★★★★★</div>
                            <div class="count" id="totalReviews">1,234 ratings</div>
                        </div>
                        <ul class="rating-bars">
                            <li class="rating-bar-item">
                                <span class="bar-label">5 stars</span>
                                <div class="bar"><div class="bar-fill" style="width: 75%"></div></div>
                                <span class="bar-count">75%</span>
                            </li>
                            <li class="rating-bar-item">
                                <span class="bar-label">4 stars</span>
                                <div class="bar"><div class="bar-fill" style="width: 15%"></div></div>
                                <span class="bar-count">15%</span>
                            </li>
                            <li class="rating-bar-item">
                                <span class="bar-label">3 stars</span>
                                <div class="bar"><div class="bar-fill" style="width: 7%"></div></div>
                                <span class="bar-count">7%</span>
                            </li>
                            <li class="rating-bar-item">
                                <span class="bar-label">2 stars</span>
                                <div class="bar"><div class="bar-fill" style="width: 2%"></div></div>
                                <span class="bar-count">2%</span>
                            </li>
                            <li class="rating-bar-item">
                                <span class="bar-label">1 star</span>
                                <div class="bar"><div class="bar-fill" style="width: 1%"></div></div>
                                <span class="bar-count">1%</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <ul class="review-list" id="reviewList">
                    <!-- Sample reviews -->
                    <li class="review-item">
                        <div class="review-header">
                            <div class="review-avatar">J</div>
                            <div class="review-meta">
                                <h4>John Doe</h4>
                                <div>
                                    <span class="stars">★★★★★</span>
                                    <span class="date">2 weeks ago</span>
                                </div>
                            </div>
                        </div>
                        <p class="review-text">
                            Excellent course! The instructor explains everything clearly and the projects are very practical. Highly recommended for anyone wanting to learn this subject.
                        </p>
                    </li>
                </ul>
            </section>
        </div>

        <!-- SIDEBAR -->
        <aside>
            <div class="sidebar-section">
                <h3>Skills you'll gain</h3>
                <ul class="skills-list" id="skillsList">
                    <li class="skill-tag">Loading...</li>
                </ul>
            </div>

            <div class="sidebar-section">
                <h3>Requirements</h3>
                <ul class="includes-list" id="requirementsList">
                    <li><i class="fas fa-check"></i> Loading...</li>
                </ul>
            </div>
        </aside>
    </div>

    <!-- SCRIPTS -->
    <script>
        const API_BASE = window.location.origin + '/api';
        const courseId = window.location.pathname.split('/').pop();
        let courseData = null;

        // Check authentication
        const token = localStorage.getItem('token');
        const user = localStorage.getItem('user');

        if (token && user) {
            const userData = JSON.parse(user);
            document.getElementById('dashboardLink').style.display = 'block';
        }

        // Load course details
        async function loadCourse() {
            try {
                const headers = {};
                if (token) {
                    headers['Authorization'] = `Bearer ${token}`;
                }

                const response = await fetch(`${API_BASE}/student/courses/${courseId}`, {
                    headers: headers
                });
                const data = await response.json();

                if (data.success && data.course) {
                    courseData = data.course;
                    renderCourse(data.course);
                } else {
                    showError('Course not found');
                }
            } catch (error) {
                console.error('Error loading course:', error);
                showError('Failed to load course');
            }
        }

        // Render course
        function renderCourse(course) {
            // Hero section
            document.getElementById('courseTitle').textContent = course.title;
            document.getElementById('courseDescription').textContent = course.description || 'No description available';
            document.getElementById('courseRating').textContent = course.rating || '4.8';
            document.getElementById('ratingCount').textContent = course.rating_count || '0';
            document.getElementById('studentCount').textContent = course.enrolled_count || '0';

            // Price
            if (course.price > 0) {
                document.getElementById('coursePrice').innerHTML = `$${course.price} <small>$${Math.round(course.price * 1.5)}</small>`;
            } else {
                document.getElementById('coursePrice').textContent = 'Free';
            }

            // Tags
            const tags = [];
            if (course.level) tags.push(`<span class="tag">${course.level}</span>`);
            if (course.category) tags.push(`<span class="tag">${course.category}</span>`);
            if (course.duration) tags.push(`<span class="tag">${course.duration}</span>`);
            document.getElementById('courseTags').innerHTML = tags.join('');

            // Duration and modules
            document.getElementById('courseDuration').textContent = course.duration || '8 hours';
            document.getElementById('moduleCount').textContent = course.modules?.length || '12';

            // Learning objectives
            if (course.learning_objectives && course.learning_objectives.length > 0) {
                const objectives = course.learning_objectives.map(obj => 
                    `<li><i class="fas fa-check"></i> ${obj}</li>`
                ).join('');
                document.getElementById('learningObjectives').innerHTML = objectives;
            }

            // Full description
            document.getElementById('fullDescription').textContent = course.full_description || course.description || 'No detailed description available';

            // Syllabus
            if (course.modules && course.modules.length > 0) {
                renderSyllabus(course.modules);
            }

            // Instructor
            document.getElementById('instructorName').textContent = course.instructor_name || 'Expert Instructor';
            document.getElementById('instructorTitle').textContent = course.instructor_title || 'Professional Instructor';
            document.getElementById('instructorAvatar').textContent = (course.instructor_name || 'I').charAt(0).toUpperCase();
            document.getElementById('instructorBio').textContent = course.instructor_bio || 'Experienced professional with years of teaching experience.';

            // Skills
            if (course.skills && course.skills.length > 0) {
                const skills = course.skills.map(skill => 
                    `<li class="skill-tag">${skill}</li>`
                ).join('');
                document.getElementById('skillsList').innerHTML = skills;
            }

            // Requirements
            if (course.requirements && course.requirements.length > 0) {
                const requirements = course.requirements.map(req => 
                    `<li><i class="fas fa-check"></i> ${req}</li>`
                ).join('');
                document.getElementById('requirementsList').innerHTML = requirements;
            }
        }

        // Render syllabus
        function renderSyllabus(modules) {
            const container = document.getElementById('syllabusContainer');
            container.innerHTML = '';

            modules.forEach((module, index) => {
                const moduleDiv = document.createElement('div');
                moduleDiv.className = 'module';
                
                const lessons = module.lessons || [];
                const totalDuration = lessons.reduce((acc, lesson) => acc + (lesson.duration || 0), 0);

                moduleDiv.innerHTML = `
                    <div class="module-header" onclick="toggleModule(${index})">
                        <div>
                            <div class="module-title">Module ${index + 1}: ${module.title}</div>
                            <div class="module-meta">${lessons.length} lessons • ${totalDuration} min</div>
                        </div>
                        <i class="fas fa-chevron-down module-toggle"></i>
                    </div>
                    <div class="module-content">
                        <ul class="lesson-list">
                            ${lessons.map((lesson, i) => `
                                <li class="lesson-item">
                                    <div class="lesson-icon">
                                        <i class="fas fa-${lesson.type === 'video' ? 'play' : 'file-alt'}"></i>
                                    </div>
                                    <div class="lesson-info">
                                        <div class="lesson-title">${i + 1}. ${lesson.title}</div>
                                        <div class="lesson-duration">${lesson.duration || 5} min</div>
                                    </div>
                                </li>
                            `).join('')}
                        </ul>
                    </div>
                `;

                container.appendChild(moduleDiv);
            });
        }

        // Toggle module
        function toggleModule(index) {
            const modules = document.querySelectorAll('.module');
            modules[index].classList.toggle('active');
        }

        // Enroll in course
        async function enrollCourse() {
            if (!token) {
                alert('Please login to enroll in this course');
                window.location.href = '/';
                return;
            }

            // Redirect to payment page with course ID
            window.location.href = `/payment?course_id=${courseId}`;
        }

        // Show error
        function showError(message) {
            document.getElementById('courseTitle').textContent = 'Error';
            document.getElementById('courseDescription').textContent = message;
        }

        // Initialize
        loadCourse();
    </script>
</body>
</html>
